---
run_id: gateway_embedder_docfetch
description: >
  Gateway hosts embedder + doc fetch + rerank + postproc so Node 1 can focus on
  FAISS only and Node 2 is a pure LLM worker. Designed to combine the two best
  individual optimizations into a single topology.

nodes:
  - number: 0
    profile: configs/gateway_embedder_docfetch_postproc.yaml
    env:
      GATEWAY_BATCH_SIZE: 6
      GATEWAY_BATCH_TIMEOUT_MS: 110
  - number: 1
    profile: configs/retrieval_faiss_only.yaml
    env:
      RETRIEVAL_BATCH_SIZE: 10
  - number: 2
    profile: configs/generation_llm_only.yaml
    env:
      GENERATION_BATCH_SIZE: 6

workload:
  requests: 160
  concurrency: 3
  rate_limit: 0.07
  timeout: 300

notes: |-
  Expect smaller payloads toward Node 1 and a lean Node 2. Compare throughput
  and p95 latency directly against gateway_embedder and gateway_docfetch runs.
