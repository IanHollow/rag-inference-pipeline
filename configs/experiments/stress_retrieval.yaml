---
run_id: stress_retrieval_long
description: >
  Push the retrieval node with large batch sizes to study FAISS/document fetch
  spikes and memory usage under sustained load. Gateway hosts embeddings to
  isolate FAISS throughput.

nodes:
  - number: 0
    profile: configs/gateway_with_embedding.yaml
    env:
      GATEWAY_BATCH_SIZE: 6
      GATEWAY_BATCH_TIMEOUT_MS: 150
  - number: 1
    profile: configs/retrieval_only.yaml
    env:
      RETRIEVAL_BATCH_SIZE: 16
  - number: 2
    profile: configs/generation.yaml
    env:
      GENERATION_BATCH_SIZE: 4

workload:
  requests: 200
  concurrency: 1
  rate_limit: 0.1
  timeout: 300

notes: |-
  Monitor FAISS search duration, Node 1 RSS, and RPC latency back to the
  gateway. Useful for determining whether FAISS becomes the new bottleneck when
  embeddings move upstream.
