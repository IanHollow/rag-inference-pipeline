---
run_id: retrieval_rerank_balanced
description: >
  Follow-up to retrieval_with_rerank that increases both retrieval and
  generation batch sizes slightly to see if throughput can break 46 req/min
  without hurting latency.

nodes:
  - number: 0
    profile: configs/baseline_gateway.yaml
    env:
      GATEWAY_BATCH_SIZE: 4
      GATEWAY_BATCH_TIMEOUT_MS: 90
      ENABLE_ADAPTIVE_BATCHING: true
  - number: 1
    profile: configs/retriever_with_rerank.yaml
    env:
      RETRIEVAL_BATCH_SIZE: 6
  - number: 2
    profile: configs/generation_no_rerank.yaml
    env:
      GENERATION_BATCH_SIZE: 6

workload:
  requests: 100
  concurrency: 1
  rate_limit: 0.2
  timeout: 300

notes: |-
  Closely related to the current top performer but with a balanced batch bump.
  Run at least twice to smooth the +/-4 req/min variance in throughput.
